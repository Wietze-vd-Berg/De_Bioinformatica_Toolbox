<h2>Je bestand wordt verwerkt...</h2>
<p id="status-message">Even geduld aub. De verwerking kan enkele minuten duren.</p>

<script>
  const taskId = "{{ task_id }}";

  function checkStatus() {
    fetch("/status/" + taskId)
      .then(response => response.json())
      .then(data => {
        if (data.status === "done") {
          window.location.href = "/resultaat/" + taskId;
        } else if (data.status === "error") {
          const message = data.error || "Er ging iets mis tijdens de verwerking.";
          document.getElementById("status-message").innerHTML = "<strong style='color:red;'>" + message + "</strong>";
        } else {
          setTimeout(checkStatus, 3000);
        }
      })
      .catch(error => {
        document.getElementById("status-message").innerHTML = "<strong style='color:red;'>Verbindingsfout: " + error + "</strong>";
      });
  }

  checkStatus();
</script>
